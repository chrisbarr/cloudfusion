<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Tarzan Pre-2.0 Trunk Build: sqs.class.php Source File</title>
<link href="tarzan.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<h1>sqs.class.php</h1><a href="a00020.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php<span class="comment"></span>
<a name="l00002"></a>00002 <span class="comment">/**</span>
<a name="l00003"></a>00003 <span class="comment"> * AMAZON SIMPLE QUEUE SERVICE (SQS)</span>
<a name="l00004"></a>00004 <span class="comment"> * http://sqs.amazonaws.com</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * @category Tarzan</span>
<a name="l00007"></a>00007 <span class="comment"> * @package SQS</span>
<a name="l00008"></a>00008 <span class="comment"> * @version 2008.07.29</span>
<a name="l00009"></a>00009 <span class="comment"> * @copyright 2006-2008 Ryan Parman, LifeNexus Digital, Inc., and contributors.</span>
<a name="l00010"></a>00010 <span class="comment"> * @license http://opensource.org/licenses/bsd-license.php Simplified BSD License</span>
<a name="l00011"></a>00011 <span class="comment"> * @link http://tarzan-aws.com Tarzan</span>
<a name="l00012"></a>00012 <span class="comment"> * @link http://sqs.amazonaws.com Amazon SQS</span>
<a name="l00013"></a>00013 <span class="comment"> * @see README</span>
<a name="l00014"></a>00014 <span class="comment"> */</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="comment">/*%******************************************************************************************%*/</span>
<a name="l00018"></a>00018 <span class="comment">// CONSTANTS</span>
<a name="l00019"></a>00019 <span class="comment"></span>
<a name="l00020"></a>00020 <span class="comment">/**</span>
<a name="l00021"></a>00021 <span class="comment"> * Specify the default queue URL.</span>
<a name="l00022"></a>00022 <span class="comment"> */</span>
<a name="l00023"></a><a class="code" href="a00020_44a336372fb4e2359bc3c75bcf35a555.html#44a336372fb4e2359bc3c75bcf35a555">00023</a> define(<span class="stringliteral">'SQS_DEFAULT_URL'</span>, <span class="stringliteral">'http://queue.amazonaws.com/'</span>);
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="comment">/*%******************************************************************************************%*/</span>
<a name="l00027"></a>00027 <span class="comment">// MAIN CLASS</span>
<a name="l00028"></a>00028 <span class="comment"></span>
<a name="l00029"></a>00029 <span class="comment">/**</span>
<a name="l00030"></a>00030 <span class="comment"> * Container for all Amazon SQS-related methods.</span>
<a name="l00031"></a>00031 <span class="comment"> */</span>
<a name="l00032"></a><a class="code" href="a00006.html">00032</a> <span class="keyword">class </span><a class="code" href="a00006.html">AmazonSQS</a> <span class="keyword">extends</span> <a class="code" href="a00007.html">TarzanCore</a>
<a name="l00033"></a>00033 {
<a name="l00034"></a>00034         <span class="comment">/*%******************************************************************************************%*/</span>
<a name="l00035"></a>00035         <span class="comment">// CONSTRUCTOR</span>
<a name="l00036"></a>00036 <span class="comment"></span>
<a name="l00037"></a>00037 <span class="comment">        /**</span>
<a name="l00038"></a>00038 <span class="comment">         * Constructor</span>
<a name="l00039"></a>00039 <span class="comment">         */</span>
<a name="l00040"></a><a class="code" href="a00006_3e353537326710b42882c991da3bcdfa.html#3e353537326710b42882c991da3bcdfa">00040</a>         <span class="keyword">public</span> function <a class="code" href="a00006_3e353537326710b42882c991da3bcdfa.html#3e353537326710b42882c991da3bcdfa">__construct</a>(<a class="code" href="a00007_84e78a190ed4df00d33fb04050b0b5f3.html#84e78a190ed4df00d33fb04050b0b5f3">$key</a> = null, <a class="code" href="a00007_cdb3e15c2f29239ddc784e3b28e7050c.html#cdb3e15c2f29239ddc784e3b28e7050c">$secret_key</a> = null, <a class="code" href="a00007_4cef61f6f9842dbb0f5b8b11d1b54de5.html#4cef61f6f9842dbb0f5b8b11d1b54de5">$account_id</a> = null, <a class="code" href="a00007_be1c319e769a5b79be53724b9b3b615b.html#be1c319e769a5b79be53724b9b3b615b">$assoc_id</a> = null)
<a name="l00041"></a>00041         {
<a name="l00042"></a>00042                 $this-&gt;api_version = <span class="stringliteral">'2008-01-01'</span>;
<a name="l00043"></a>00043                 parent::__construct(<a class="code" href="a00007_84e78a190ed4df00d33fb04050b0b5f3.html#84e78a190ed4df00d33fb04050b0b5f3">$key</a>, <a class="code" href="a00007_cdb3e15c2f29239ddc784e3b28e7050c.html#cdb3e15c2f29239ddc784e3b28e7050c">$secret_key</a>, <a class="code" href="a00007_4cef61f6f9842dbb0f5b8b11d1b54de5.html#4cef61f6f9842dbb0f5b8b11d1b54de5">$account_id</a>, <a class="code" href="a00007_be1c319e769a5b79be53724b9b3b615b.html#be1c319e769a5b79be53724b9b3b615b">$assoc_id</a>);
<a name="l00044"></a>00044         }
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 
<a name="l00047"></a>00047         <span class="comment">/*%******************************************************************************************%*/</span>
<a name="l00048"></a>00048         <span class="comment">// QUEUES</span>
<a name="l00049"></a>00049 <span class="comment"></span>
<a name="l00050"></a>00050 <span class="comment">        /**</span>
<a name="l00051"></a>00051 <span class="comment">         * Create Queue</span>
<a name="l00052"></a>00052 <span class="comment">         *</span>
<a name="l00053"></a>00053 <span class="comment">         * The CreateQueue action creates a new queue. You must provide a queue name that is unique within </span>
<a name="l00054"></a>00054 <span class="comment">         * the scope of the queues you own. The queue is assigned a queue URL; you must use this URL when </span>
<a name="l00055"></a>00055 <span class="comment">         * performing actions on the queue. When you create a queue, if a queue with the same name already </span>
<a name="l00056"></a>00056 <span class="comment">         * exists, CreateQueue returns the queue URL with an error indicating that the queue already exists.</span>
<a name="l00057"></a>00057 <span class="comment">         *</span>
<a name="l00058"></a>00058 <span class="comment">         * @access public</span>
<a name="l00059"></a>00059 <span class="comment">         * @param string $queue_name (Required) The name to use for the queue created. The queue name must be unique within the scope of all your queues.</span>
<a name="l00060"></a>00060 <span class="comment">         * @param boolean $returnCurlHandle (Optional) A private toggle that will return the CURL handle for the request rather than actually completing the request. This is useful for MultiCURL requests.</span>
<a name="l00061"></a>00061 <span class="comment">         * @return TarzanHTTPResponse</span>
<a name="l00062"></a>00062 <span class="comment">         * @see http://docs.amazonwebservices.com/AWSSimpleQueueService/2008-01-01/SQSDeveloperGuide/Query_QueryCreateQueue.html</span>
<a name="l00063"></a>00063 <span class="comment">         */</span>
<a name="l00064"></a><a class="code" href="a00006_4a8f14c591483faeb3b8f12534385839.html#4a8f14c591483faeb3b8f12534385839">00064</a>         <span class="keyword">public</span> function <a class="code" href="a00006_4a8f14c591483faeb3b8f12534385839.html#4a8f14c591483faeb3b8f12534385839">create_queue</a>($queue_name, $returnCurlHandle = null)
<a name="l00065"></a>00065         {
<a name="l00066"></a>00066                 $opt[<span class="stringliteral">'QueueName'</span>] = $queue_name;
<a name="l00067"></a>00067                 $opt[<span class="stringliteral">'returnCurlHandle'</span>] = $returnCurlHandle;
<a name="l00068"></a>00068                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00007_3fb0bd4332f737732312815e5f4211f8.html#3fb0bd4332f737732312815e5f4211f8">authenticate</a>(<span class="stringliteral">'CreateQueue'</span>, $opt, <a class="code" href="a00020_44a336372fb4e2359bc3c75bcf35a555.html#44a336372fb4e2359bc3c75bcf35a555">SQS_DEFAULT_URL</a>);
<a name="l00069"></a>00069         }
<a name="l00070"></a>00070 <span class="comment"></span>
<a name="l00071"></a>00071 <span class="comment">        /**</span>
<a name="l00072"></a>00072 <span class="comment">         * Delete Queue</span>
<a name="l00073"></a>00073 <span class="comment">         *</span>
<a name="l00074"></a>00074 <span class="comment">         * Deletes the queue specified by the queue URL. This will delete the queue, even if it's not empty.</span>
<a name="l00075"></a>00075 <span class="comment">         *</span>
<a name="l00076"></a>00076 <span class="comment">         * @access public</span>
<a name="l00077"></a>00077 <span class="comment">         * @param string $queue_url (Required) The URL of the queue to perform the action on.</span>
<a name="l00078"></a>00078 <span class="comment">         * @param boolean $returnCurlHandle (Optional) A private toggle that will return the CURL handle for the request rather than actually completing the request. This is useful for MultiCURL requests.</span>
<a name="l00079"></a>00079 <span class="comment">         * @return TarzanHTTPResponse</span>
<a name="l00080"></a>00080 <span class="comment">         * @see http://docs.amazonwebservices.com/AWSSimpleQueueService/2008-01-01/SQSDeveloperGuide/Query_QueryDeleteQueue.html</span>
<a name="l00081"></a>00081 <span class="comment">         */</span>
<a name="l00082"></a><a class="code" href="a00006_fd930b7cc5e14dbcec65d0c755b529a9.html#fd930b7cc5e14dbcec65d0c755b529a9">00082</a>         <span class="keyword">public</span> function <a class="code" href="a00006_fd930b7cc5e14dbcec65d0c755b529a9.html#fd930b7cc5e14dbcec65d0c755b529a9">delete_queue</a>($queue_url, $returnCurlHandle = null)
<a name="l00083"></a>00083         {
<a name="l00084"></a>00084                 $opt = array();
<a name="l00085"></a>00085                 $opt[<span class="stringliteral">'returnCurlHandle'</span>] = $returnCurlHandle;
<a name="l00086"></a>00086                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00007_3fb0bd4332f737732312815e5f4211f8.html#3fb0bd4332f737732312815e5f4211f8">authenticate</a>(<span class="stringliteral">'DeleteQueue'</span>, $opt, $queue_url);
<a name="l00087"></a>00087         }
<a name="l00088"></a>00088 <span class="comment"></span>
<a name="l00089"></a>00089 <span class="comment">        /**</span>
<a name="l00090"></a>00090 <span class="comment">         * List Queues</span>
<a name="l00091"></a>00091 <span class="comment">         *</span>
<a name="l00092"></a>00092 <span class="comment">         * The ListQueues action returns a list of your queues. A maximum 1000 queue URLs are returned. If </span>
<a name="l00093"></a>00093 <span class="comment">         * you specify a value for the optional QueueNamePrefix parameter, only queues with a name beginning </span>
<a name="l00094"></a>00094 <span class="comment">         * with the specified value are returned.</span>
<a name="l00095"></a>00095 <span class="comment">         *</span>
<a name="l00096"></a>00096 <span class="comment">         * @access public</span>
<a name="l00097"></a>00097 <span class="comment">         * @param string $queue_name_prefix (Optional) String to use for filtering the list results. Only those queues whose name begins with the specified string are returned.</span>
<a name="l00098"></a>00098 <span class="comment">         * @param boolean $returnCurlHandle (Optional) A private toggle that will return the CURL handle for the request rather than actually completing the request. This is useful for MultiCURL requests.</span>
<a name="l00099"></a>00099 <span class="comment">         * @return TarzanHTTPResponse</span>
<a name="l00100"></a>00100 <span class="comment">         * @see http://docs.amazonwebservices.com/AWSSimpleQueueService/2008-01-01/SQSDeveloperGuide/Query_QueryListQueues.html</span>
<a name="l00101"></a>00101 <span class="comment">         */</span>
<a name="l00102"></a><a class="code" href="a00006_19b651645428d3152027ffbf4629e167.html#19b651645428d3152027ffbf4629e167">00102</a>         <span class="keyword">public</span> function <a class="code" href="a00006_19b651645428d3152027ffbf4629e167.html#19b651645428d3152027ffbf4629e167">list_queues</a>($queue_name_prefix = null, $returnCurlHandle = null)
<a name="l00103"></a>00103         {
<a name="l00104"></a>00104                 $opt = array();
<a name="l00105"></a>00105                 $opt[<span class="stringliteral">'returnCurlHandle'</span>] = $returnCurlHandle;
<a name="l00106"></a>00106                 <span class="keywordflow">if</span> ($queue_name_prefix)
<a name="l00107"></a>00107                 {
<a name="l00108"></a>00108                         $opt[<span class="stringliteral">'QueueNamePrefix'</span>] = $queue_name_prefix;
<a name="l00109"></a>00109                 }
<a name="l00110"></a>00110                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00007_3fb0bd4332f737732312815e5f4211f8.html#3fb0bd4332f737732312815e5f4211f8">authenticate</a>(<span class="stringliteral">'ListQueues'</span>, $opt, <a class="code" href="a00020_44a336372fb4e2359bc3c75bcf35a555.html#44a336372fb4e2359bc3c75bcf35a555">SQS_DEFAULT_URL</a>);
<a name="l00111"></a>00111         }
<a name="l00112"></a>00112 <span class="comment"></span>
<a name="l00113"></a>00113 <span class="comment">        /**</span>
<a name="l00114"></a>00114 <span class="comment">         * Get Queue Attributes</span>
<a name="l00115"></a>00115 <span class="comment">         *</span>
<a name="l00116"></a>00116 <span class="comment">         * Gets one or all attributes of a queue.</span>
<a name="l00117"></a>00117 <span class="comment">         *</span>
<a name="l00118"></a>00118 <span class="comment">         * @access public</span>
<a name="l00119"></a>00119 <span class="comment">         * @param string $queue_url (Required) The URL of the queue to perform the action on.</span>
<a name="l00120"></a>00120 <span class="comment">         * @param boolean $returnCurlHandle (Optional) A private toggle that will return the CURL handle for the request rather than actually completing the request. This is useful for MultiCURL requests.</span>
<a name="l00121"></a>00121 <span class="comment">         * @return TarzanHTTPResponse</span>
<a name="l00122"></a>00122 <span class="comment">         * @see http://docs.amazonwebservices.com/AWSSimpleQueueService/2008-01-01/SQSDeveloperGuide/Query_QueryGetQueueAttributes.html</span>
<a name="l00123"></a>00123 <span class="comment">         */</span>
<a name="l00124"></a><a class="code" href="a00006_b9deaa55ceb1bb00327072c5e71b321c.html#b9deaa55ceb1bb00327072c5e71b321c">00124</a>         <span class="keyword">public</span> function <a class="code" href="a00006_b9deaa55ceb1bb00327072c5e71b321c.html#b9deaa55ceb1bb00327072c5e71b321c">get_queue_attributes</a>($queue_url, $returnCurlHandle = null)
<a name="l00125"></a>00125         {
<a name="l00126"></a>00126                 $opt = array();
<a name="l00127"></a>00127                 $opt[<span class="stringliteral">'AttributeName'</span>] = <span class="stringliteral">'All'</span>;
<a name="l00128"></a>00128                 $opt[<span class="stringliteral">'returnCurlHandle'</span>] = $returnCurlHandle;
<a name="l00129"></a>00129                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00007_3fb0bd4332f737732312815e5f4211f8.html#3fb0bd4332f737732312815e5f4211f8">authenticate</a>(<span class="stringliteral">'GetQueueAttributes'</span>, $opt, $queue_url);
<a name="l00130"></a>00130         }
<a name="l00131"></a>00131 <span class="comment"></span>
<a name="l00132"></a>00132 <span class="comment">        /**</span>
<a name="l00133"></a>00133 <span class="comment">         * Set Queue Attributes</span>
<a name="l00134"></a>00134 <span class="comment">         *</span>
<a name="l00135"></a>00135 <span class="comment">         * Sets an attribute of a queue. Currently, you can set only the VisibilityTimeout attribute for a </span>
<a name="l00136"></a>00136 <span class="comment">         * queue. See Visibility Timeout for more information.</span>
<a name="l00137"></a>00137 <span class="comment">         *</span>
<a name="l00138"></a>00138 <span class="comment">         * @access public</span>
<a name="l00139"></a>00139 <span class="comment">         * @param string $queue_url (Required) The URL of the queue to perform the action on.</span>
<a name="l00140"></a>00140 <span class="comment">         * @param array $opt Associative array of parameters which can have the following keys:</span>
<a name="l00141"></a>00141 <span class="comment">         * &lt;ul&gt;</span>
<a name="l00142"></a>00142 <span class="comment">         *   &lt;li&gt;integer VisibilityTimeout - (Optional) Must be an integer from 0 to 7200 (2 hours).&lt;/li&gt;</span>
<a name="l00143"></a>00143 <span class="comment">         *   &lt;li&gt;boolean $returnCurlHandle - (Optional) A private toggle that will return the CURL handle for the request rather than actually completing the request. This is useful for MultiCURL requests.&lt;/li&gt;</span>
<a name="l00144"></a>00144 <span class="comment">         * &lt;/ul&gt;</span>
<a name="l00145"></a>00145 <span class="comment">         * @return TarzanHTTPResponse</span>
<a name="l00146"></a>00146 <span class="comment">         * @see http://docs.amazonwebservices.com/AWSSimpleQueueService/2008-01-01/SQSDeveloperGuide/Query_QueryGetQueueAttributes.html</span>
<a name="l00147"></a>00147 <span class="comment">         */</span>
<a name="l00148"></a><a class="code" href="a00006_e057b950a34ccf1690a8bc0420a769bf.html#e057b950a34ccf1690a8bc0420a769bf">00148</a>         <span class="keyword">public</span> function <a class="code" href="a00006_e057b950a34ccf1690a8bc0420a769bf.html#e057b950a34ccf1690a8bc0420a769bf">set_queue_attributes</a>($queue_url, $opt = null)
<a name="l00149"></a>00149         {
<a name="l00150"></a>00150                 <span class="keywordflow">if</span> (isset($opt[<span class="stringliteral">'VisibilityTimeout'</span>]))
<a name="l00151"></a>00151                 {
<a name="l00152"></a>00152                         $opt[<span class="stringliteral">'Attribute.Name'</span>] = <span class="stringliteral">'VisibilityTimeout'</span>;
<a name="l00153"></a>00153                         $opt[<span class="stringliteral">'Attribute.Value'</span>] = $opt[<span class="stringliteral">'VisibilityTimeout'</span>];
<a name="l00154"></a>00154                         unset($opt[<span class="stringliteral">'VisibilityTimeout'</span>]);
<a name="l00155"></a>00155                 }
<a name="l00156"></a>00156                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00007_3fb0bd4332f737732312815e5f4211f8.html#3fb0bd4332f737732312815e5f4211f8">authenticate</a>(<span class="stringliteral">'SetQueueAttributes'</span>, $opt, $queue_url);
<a name="l00157"></a>00157         }
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 
<a name="l00160"></a>00160         <span class="comment">/*%******************************************************************************************%*/</span>
<a name="l00161"></a>00161         <span class="comment">// MESSAGES</span>
<a name="l00162"></a>00162 <span class="comment"></span>
<a name="l00163"></a>00163 <span class="comment">        /**</span>
<a name="l00164"></a>00164 <span class="comment">         * Send Message</span>
<a name="l00165"></a>00165 <span class="comment">         *</span>
<a name="l00166"></a>00166 <span class="comment">         * The SendMessage action delivers a message to the specified queue.</span>
<a name="l00167"></a>00167 <span class="comment">         *</span>
<a name="l00168"></a>00168 <span class="comment">         * @access public</span>
<a name="l00169"></a>00169 <span class="comment">         * @param string $queue_url (Required) The URL of the queue to perform the action on.</span>
<a name="l00170"></a>00170 <span class="comment">         * @param string $message (Required) Message size cannot exceed 8 KB. Allowed Unicode characters (according to http://www.w3.org/TR/REC-xml/#charsets): #x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]</span>
<a name="l00171"></a>00171 <span class="comment">         * @param boolean $returnCurlHandle (Optional) A private toggle that will return the CURL handle for the request rather than actually completing the request. This is useful for MultiCURL requests.</span>
<a name="l00172"></a>00172 <span class="comment">         * @return TarzanHTTPResponse</span>
<a name="l00173"></a>00173 <span class="comment">         * @see http://docs.amazonwebservices.com/AWSSimpleQueueService/2008-01-01/SQSDeveloperGuide/Query_QuerySendMessage.html</span>
<a name="l00174"></a>00174 <span class="comment">         */</span>
<a name="l00175"></a><a class="code" href="a00006_41d43edf6ec74c40b0402f5ee461766d.html#41d43edf6ec74c40b0402f5ee461766d">00175</a>         <span class="keyword">public</span> function <a class="code" href="a00006_41d43edf6ec74c40b0402f5ee461766d.html#41d43edf6ec74c40b0402f5ee461766d">send_message</a>($queue_url, $message, $returnCurlHandle = null)
<a name="l00176"></a>00176         {
<a name="l00177"></a>00177                 $opt = array();
<a name="l00178"></a>00178                 $opt[<span class="stringliteral">'returnCurlHandle'</span>] = $returnCurlHandle;
<a name="l00179"></a>00179                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00007_3fb0bd4332f737732312815e5f4211f8.html#3fb0bd4332f737732312815e5f4211f8">authenticate</a>(<span class="stringliteral">'SendMessage'</span>, $opt, $queue_url, $message);
<a name="l00180"></a>00180         }
<a name="l00181"></a>00181 <span class="comment"></span>
<a name="l00182"></a>00182 <span class="comment">        /**</span>
<a name="l00183"></a>00183 <span class="comment">         * Receive Message</span>
<a name="l00184"></a>00184 <span class="comment">         *</span>
<a name="l00185"></a>00185 <span class="comment">         * Retrieves one or more messages from the specified queue, including the message body and message </span>
<a name="l00186"></a>00186 <span class="comment">         * ID of each message. Messages returned by this action stay in the queue until you delete them. </span>
<a name="l00187"></a>00187 <span class="comment">         * However, once a message is returned to a ReceiveMessage request, it is not returned on subsequent </span>
<a name="l00188"></a>00188 <span class="comment">         * ReceiveMessage requests for the duration of the VisibilityTimeout. If you do not specify a </span>
<a name="l00189"></a>00189 <span class="comment">         * VisibilityTimeout in the request, the overall visibility timeout for the queue is used for the </span>
<a name="l00190"></a>00190 <span class="comment">         * returned messages. A default visibility timeout of 30 seconds is set when you create the queue. </span>
<a name="l00191"></a>00191 <span class="comment">         * You can also set the visibility timeout for the queue by using SetQueueAttributes. See Visibility </span>
<a name="l00192"></a>00192 <span class="comment">         * Timeout for more information.</span>
<a name="l00193"></a>00193 <span class="comment">         *</span>
<a name="l00194"></a>00194 <span class="comment">         * @access public</span>
<a name="l00195"></a>00195 <span class="comment">         * @param string $queue_url (Required) The URL of the queue to perform the action on.</span>
<a name="l00196"></a>00196 <span class="comment">         * @param array $opt Associative array of parameters which can have the following keys:</span>
<a name="l00197"></a>00197 <span class="comment">         * &lt;ul&gt;</span>
<a name="l00198"></a>00198 <span class="comment">         *   &lt;li&gt;integer MaxNumberOfMessages - (Optional) Maximum number of messages to return, from 1 to 10. Not necessarily all the messages in the queue are returned. If there are fewer messages in the queue than NumberOfMessages, the maximum number of messages returned is the current number of messages in the queue. Defaults to 1 message.&lt;/li&gt;</span>
<a name="l00199"></a>00199 <span class="comment">         *   &lt;li&gt;integer VisibilityTimeout - (Optional) An integer from 0 to 86400 (24 hours). Defaults to 30 seconds.&lt;/li&gt;</span>
<a name="l00200"></a>00200 <span class="comment">         *   &lt;li&gt;boolean $returnCurlHandle - (Optional) A private toggle that will return the CURL handle for the request rather than actually completing the request. This is useful for MultiCURL requests.&lt;/li&gt;</span>
<a name="l00201"></a>00201 <span class="comment">         * &lt;/ul&gt;</span>
<a name="l00202"></a>00202 <span class="comment">         * @return TarzanHTTPResponse</span>
<a name="l00203"></a>00203 <span class="comment">         * @see http://docs.amazonwebservices.com/AWSSimpleQueueService/2008-01-01/SQSDeveloperGuide/Query_QueryReceiveMessage.html</span>
<a name="l00204"></a>00204 <span class="comment">         */</span>
<a name="l00205"></a><a class="code" href="a00006_b7ebbccfff7f384bec80711966cfbe6c.html#b7ebbccfff7f384bec80711966cfbe6c">00205</a>         <span class="keyword">public</span> function <a class="code" href="a00006_b7ebbccfff7f384bec80711966cfbe6c.html#b7ebbccfff7f384bec80711966cfbe6c">receive_message</a>($queue_url, $opt = null)
<a name="l00206"></a>00206         {
<a name="l00207"></a>00207                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00007_3fb0bd4332f737732312815e5f4211f8.html#3fb0bd4332f737732312815e5f4211f8">authenticate</a>(<span class="stringliteral">'ReceiveMessage'</span>, $opt, $queue_url);
<a name="l00208"></a>00208         }
<a name="l00209"></a>00209 <span class="comment"></span>
<a name="l00210"></a>00210 <span class="comment">        /**</span>
<a name="l00211"></a>00211 <span class="comment">         * Delete Message</span>
<a name="l00212"></a>00212 <span class="comment">         *</span>
<a name="l00213"></a>00213 <span class="comment">         * The DeleteMessage action unconditionally removes the specified message from the specified queue. Even if </span>
<a name="l00214"></a>00214 <span class="comment">         * the message is locked by another reader due to the visibility timeout setting, it is still deleted from </span>
<a name="l00215"></a>00215 <span class="comment">         * the queue.</span>
<a name="l00216"></a>00216 <span class="comment">         *</span>
<a name="l00217"></a>00217 <span class="comment">         * @access public</span>
<a name="l00218"></a>00218 <span class="comment">         * @param string $queue_url (Required) The URL of the queue to perform the action on.</span>
<a name="l00219"></a>00219 <span class="comment">         * @param string $receipt_handle (Required) The receipt handle of the message to return.</span>
<a name="l00220"></a>00220 <span class="comment">         * @param boolean $returnCurlHandle (Optional) A private toggle that will return the CURL handle for the request rather than actually completing the request. This is useful for MultiCURL requests.</span>
<a name="l00221"></a>00221 <span class="comment">         * @return TarzanHTTPResponse</span>
<a name="l00222"></a>00222 <span class="comment">         * @see http://docs.amazonwebservices.com/AWSSimpleQueueService/2008-01-01/SQSDeveloperGuide/Query_QueryDeleteMessage.html</span>
<a name="l00223"></a>00223 <span class="comment">         */</span>
<a name="l00224"></a><a class="code" href="a00006_5548c87c581d5797dbf17e3ec67686fa.html#5548c87c581d5797dbf17e3ec67686fa">00224</a>         <span class="keyword">public</span> function <a class="code" href="a00006_5548c87c581d5797dbf17e3ec67686fa.html#5548c87c581d5797dbf17e3ec67686fa">delete_message</a>($queue_url, $receipt_handle, $returnCurlHandle = null)
<a name="l00225"></a>00225         {
<a name="l00226"></a>00226                 $opt = array();
<a name="l00227"></a>00227                 $opt[<span class="stringliteral">'ReceiptHandle'</span>] = $receipt_handle;
<a name="l00228"></a>00228                 $opt[<span class="stringliteral">'returnCurlHandle'</span>] = $returnCurlHandle;
<a name="l00229"></a>00229                 <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00007_3fb0bd4332f737732312815e5f4211f8.html#3fb0bd4332f737732312815e5f4211f8">authenticate</a>(<span class="stringliteral">'DeleteMessage'</span>, $opt, $queue_url);
<a name="l00230"></a>00230         }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 
<a name="l00233"></a>00233         <span class="comment">/*%******************************************************************************************%*/</span>
<a name="l00234"></a>00234         <span class="comment">// HELPER/UTILITY METHODS</span>
<a name="l00235"></a>00235 <span class="comment"></span>
<a name="l00236"></a>00236 <span class="comment">        /**</span>
<a name="l00237"></a>00237 <span class="comment">         * Get Queue Size</span>
<a name="l00238"></a>00238 <span class="comment">         * </span>
<a name="l00239"></a>00239 <span class="comment">         * Retrieves the approximate number of messages in the queue.</span>
<a name="l00240"></a>00240 <span class="comment">         *</span>
<a name="l00241"></a>00241 <span class="comment">         * @access public</span>
<a name="l00242"></a>00242 <span class="comment">         * @param string $queue_url (Required) The URL of the queue to perform the action on.</span>
<a name="l00243"></a>00243 <span class="comment">         * @return integer The Approximate number of messages.</span>
<a name="l00244"></a>00244 <span class="comment">         */</span>
<a name="l00245"></a><a class="code" href="a00006_ac606d67a32faf3e8e0076023d590c84.html#ac606d67a32faf3e8e0076023d590c84">00245</a>         <span class="keyword">public</span> function <a class="code" href="a00006_ac606d67a32faf3e8e0076023d590c84.html#ac606d67a32faf3e8e0076023d590c84">get_queue_size</a>($queue_url)
<a name="l00246"></a>00246         {
<a name="l00247"></a>00247                 $opt = array();
<a name="l00248"></a>00248                 $opt[<span class="stringliteral">'AttributeName'</span>] = <span class="stringliteral">'ApproximateNumberOfMessages'</span>;
<a name="l00249"></a>00249                 $response = $this-&gt;<a class="code" href="a00007_3fb0bd4332f737732312815e5f4211f8.html#3fb0bd4332f737732312815e5f4211f8">authenticate</a>(<span class="stringliteral">'GetQueueAttributes'</span>, $opt, $queue_url);
<a name="l00250"></a>00250                 <span class="keywordflow">return</span> (integer) $response-&gt;body-&gt;GetQueueAttributesResult-&gt;Attribute-&gt;Value;
<a name="l00251"></a>00251         }
<a name="l00252"></a>00252 }
<a name="l00253"></a>00253 ?&gt;
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Aug 2 15:48:01 2008 for Tarzan Pre-2.0 Trunk Build by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
