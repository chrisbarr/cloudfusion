<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Tarzan Pre-2.0 Trunk Build: AmazonSDB::query_with_attributes</title>
<link href="tarzan.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="contents">
  <div class="navpath"><a class="el" href="a00004.html">AmazonSDB</a>
  </div>
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
   <td valign="top">
      <div class="navtab">
        <table>
          <tr><td class="navtab"><a class="qindex" href="a00004_c8e126eeec8a04b7693da7175af39d69.html#c8e126eeec8a04b7693da7175af39d69">__construct</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="a00004_91adb5f512c9e2f6225663bc3daea021.html#91adb5f512c9e2f6225663bc3daea021">create_domain</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="a00004_78594f382e633f8432115b2dd5b0e9cc.html#78594f382e633f8432115b2dd5b0e9cc">delete_attributes</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="a00004_ff027b1b53382a6292d9fe0101064174.html#ff027b1b53382a6292d9fe0101064174">delete_domain</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="a00004_8291d13e0983869c762759337a395e9d.html#8291d13e0983869c762759337a395e9d">get_attributes</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="a00004_631357b55145d23b091ac82f7a76b04f.html#631357b55145d23b091ac82f7a76b04f">list_domains</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="a00004_43caa054e9a0acb8dadef26977ba9b9b.html#43caa054e9a0acb8dadef26977ba9b9b">put_attributes</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="a00004_50152c2d14898b9050ef7bb038a832e0.html#50152c2d14898b9050ef7bb038a832e0">query</a></td></tr>
          <tr><td class="navtab"><a class="qindexHL" href="a00004_0e30f8619a7aa9bba970e25f4b7fa928.html#0e30f8619a7aa9bba970e25f4b7fa928">query_with_attributes</a></td></tr>
        </table>
      </div>
   </td>
   <td valign="top">
<a class="anchor" name="0e30f8619a7aa9bba970e25f4b7fa928"></a><!-- doxytag: member="AmazonSDB::query_with_attributes" ref="0e30f8619a7aa9bba970e25f4b7fa928" args="($domain_name, $opt=null, $expression=null)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AmazonSDB::query_with_attributes           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>domain_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>opt</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>expression</em> = <code>null</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
QueryWithAttributes<p>
The QueryWithAttributes operation returns a set of Attributes for ItemNames that match the query expression. QueryWithAttributes operations that run longer than 5 seconds will likely time-out and return a time-out error response. A QueryWithAttributes with no QueryExpression matches all items in the domain.<p>
The total size of the response cannot exceed 1 MB in total size. Amazon SimpleDB automatically adjusts the number of items returned per page to enforce this limit. For example, even if you ask to retrieve 250 items, but each individual item is 100 kB in size, the system returns 10 items and an appropriate NextToken to get the next page of results.<p>
public <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>string</em>&nbsp;</td><td>$domain_name (Required) The name of the domain to use. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>array</em>&nbsp;</td><td>$opt Associative array of parameters which can have the following keys: <ul>
<li>
string AttributeName - (Optional) The name of the attribute to return. To return multiple attributes, you can specify this request parameter multiple times. </li>
<li>
integer MaxNumberOfItems - (Optional) The maximum number of item names you want returned. The range is 1 to 250, defaults to 100. </li>
<li>
string NextToken - (Optional) String that tells Amazon SimpleDB where to start the next list of domain names. </li>
</ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>string</em>&nbsp;</td><td>$expression (Optional) The SimpleDB query expression to use. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>boolean</em>&nbsp;</td><td>$follow (Optional) Whether to take the next step and fetch the items that are returned. Defaults to false. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><a class="el" href="a00008.html">TarzanHTTPResponse</a> </dd></dl>
<h2><a class="anchor" name="example">
Example Usage:</a></h2>
<div class="fragment"><pre class="fragment">&lt;?php
require_once(<span class="stringliteral">'tarzan.class.php'</span>);
<span class="comment"></span>
<span class="comment">/**</span>
<span class="comment"> * Instantiate a new AmazonSDB object using the settings from the config.inc.php file.</span>
<span class="comment"> */</span>
$sdb = <span class="keyword">new</span> <a class="code" href="a00004.html">AmazonSDB</a>();

<span class="comment"></span>
<span class="comment">/**</span>
<span class="comment"> * Query SimpleDB for items containing data. Returns all matches up to 250 items. A </span>
<span class="comment"> * separate request is required to return back the full data for the items returned </span>
<span class="comment"> * in this query. (See below for more info.)</span>
<span class="comment"> */</span>
$query = $sdb-&gt;query_with_attributes(<span class="stringliteral">'warpshare_test'</span>, array(
        <span class="stringliteral">'MaxNumberOfItems'</span> =&gt; 250
));

<span class="comment"></span>
<span class="comment">/**</span>
<span class="comment"> * Look at the response to navigate through the headers and body of the response.</span>
<span class="comment"> * Note that this is an object, not an array, and that the body is a SimpleXML object.</span>
<span class="comment"> * </span>
<span class="comment"> * http://php.net/manual/en/simplexml.examples.php</span>
<span class="comment"> */</span>
echo <span class="stringliteral">'&lt;pre&gt;'</span>;
print_r($query);
echo <span class="stringliteral">'&lt;/pre&gt;'</span>;


<span class="comment">/*========================================================*/</span>

<span class="comment"></span>
<span class="comment">/**</span>
<span class="comment"> * Same as above, but we're using a complex SimpleDB expression to pull back specific items. </span>
<span class="comment"> * (Added linebreaks for readability.)</span>
<span class="comment"> */</span>
$query = $sdb-&gt;$query_with_attributes(<span class="stringliteral">'warpshare_test'</span>, 
        array(
                <span class="stringliteral">'MaxNumberOfItems'</span> =&gt; 250
        ), 
        <span class="stringliteral">"['Year' &gt;= '1900' and 'Year' &lt; '2000'] intersection ['Keyword' = 'Book'] intersection ['Rating' starts-with '4' or 'Rating' = '****'] union ['Title' = '300'] union ['Author' = 'Paul Van Dyk']"</span>
);

<span class="comment"></span>
<span class="comment">/**</span>
<span class="comment"> * Same as above, but we're using a complex SimpleDB expression to pull back specific items, </span>
<span class="comment"> * and then request those items all at once so that query responses also contain the </span>
<span class="comment"> * data for the relevant items. (Added linebreaks for readability.)</span>
<span class="comment"> */</span>
$query = $sdb-&gt;$query_with_attributes(<span class="stringliteral">'warpshare_test'</span>, 
        array(
                <span class="stringliteral">'MaxNumberOfItems'</span> =&gt; 250
        ), 
        <span class="stringliteral">"['Year' &gt;= '1900' and 'Year' &lt; '2000'] intersection ['Keyword' = 'Book'] intersection ['Rating' starts-with '4' or 'Rating' = '****'] union ['Title' = '300'] union ['Author' = 'Paul Van Dyk']"</span>, 
        <span class="keyword">true</span>
);


?&gt;
</pre></div> <dl class="see" compact><dt><b>See also:</b></dt><dd><a href="http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/SDB_API_QueryWithAttributes.html">http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/SDB_API_QueryWithAttributes.html</a> </dd></dl>

<p>Definition at line <a class="el" href="a00043.html#l00445">445</a> of file <a class="el" href="a00043.html">sdb.class.php</a>.</p>

<p>References <a class="el" href="a00045.html#l00301">TarzanCore::authenticate()</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00446"></a>00446         {
<a name="l00447"></a>00447                 <span class="keywordflow">if</span> (!$opt)
<a name="l00448"></a>00448                 {
<a name="l00449"></a>00449                         $opt = array();
<a name="l00450"></a>00450                 }
<a name="l00451"></a>00451 
<a name="l00452"></a>00452                 $opt[<span class="stringliteral">'DomainName'</span>] = $domain_name;
<a name="l00453"></a>00453                 $opt[<span class="stringliteral">'QueryExpression'</span>] = $expression;
<a name="l00454"></a>00454 
<a name="l00455"></a>00455                 $query = $this-&gt;<a class="code" href="a00006_3fb0bd4332f737732312815e5f4211f8.html#3fb0bd4332f737732312815e5f4211f8">authenticate</a>(<span class="stringliteral">'QueryWithAttributes'</span>, $opt, <a class="code" href="a00020_8190cd4624261979beb11b7c5d1b209a.html#8190cd4624261979beb11b7c5d1b209a">SDB_DEFAULT_URL</a>);
<a name="l00456"></a>00456 
<a name="l00457"></a>00457                 <span class="keywordflow">return</span> $query;
<a name="l00458"></a>00458         }
</pre></div>
<p>

</div>
</div><p>
    </td>
  </tr>
</table>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Aug 23 19:17:11 2008 for Tarzan Pre-2.0 Trunk Build by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
